# Trading Fitness - mise configuration
# SSoT for runtime versions and environment

[env]
GH_TOKEN = "{{ read_file(path=env.HOME ~ '/.claude/.secrets/gh-token-terrylica') | trim }}"
GITHUB_TOKEN = "{{ read_file(path=env.HOME ~ '/.claude/.secrets/gh-token-terrylica') | trim }}"
LOG_DIR = "{{config_root}}/logs"
ENV = "dev"

[tools]
python = "3.12"    # SSoT-OK: mise manages runtime versions
rust = "stable"    # SSoT-OK: mise manages runtime versions
node = "22"        # SSoT-OK: mise manages runtime versions
bun = "latest"     # SSoT-OK: mise manages runtime versions
uv = "latest"      # SSoT-OK: mise manages runtime versions
"cargo:ast-grep" = "latest"  # SSoT-OK: structural code search

[tasks.lint]
description = "Lint all packages"
run = "cd packages/ith-python && uv run ruff check --fix"

[tasks.test]
description = "Test all packages"
run = "cd packages/ith-python && uv run pytest"

[tasks.analyze]
description = "Run ITH analysis (bull + bear)"
depends = ["analyze:bull", "analyze:bear"]

[tasks."analyze:bull"]
description = "Run Bull (long) ITH analysis"
run = "cd packages/ith-python && uv run python -m ith_python.ith"

[tasks."analyze:bear"]
description = "Run Bear (short) ITH analysis"
run = "cd packages/ith-python && uv run python -m ith_python.bear_ith"

[tasks.affected]
description = "List affected packages"
run = "bash scripts/affected.sh list"

[tasks."test:affected"]
run = "bash scripts/affected.sh test"

[tasks.generate-types]
description = "Generate types from JSON Schema"
run = "bash scripts/generate-types.sh all"

[tasks."generate-types:python"]
description = "Generate Python types from JSON Schema"
run = "bash scripts/generate-types.sh python"

[tasks."generate-types:typescript"]
description = "Generate TypeScript types from JSON Schema"
run = "bash scripts/generate-types.sh typescript"

[tasks."generate-types:rust"]
description = "Generate Rust types from JSON Schema"
run = "bash scripts/generate-types.sh rust"
